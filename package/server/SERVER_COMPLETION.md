# ğŸ‰ Server åŒ…åˆ›å»ºå®Œæˆ

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é¡¹ç›®ç»“æ„
```
package/server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js                 # ä¸»å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ recording.js         # å½•åˆ¶æ•°æ®ç®¡ç†
â”‚       â””â”€â”€ playback.js          # å›æ”¾é¡µé¢ç”Ÿæˆ
â”œâ”€â”€ test/
â”‚   â””â”€â”€ api-test.js             # API æµ‹è¯•è„šæœ¬
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ vue-integration.js       # Vue é›†æˆç¤ºä¾‹
â”œâ”€â”€ data/                        # æ•°æ®å­˜å‚¨ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â””â”€â”€ recordings/              # å½•åˆ¶æ–‡ä»¶å­˜å‚¨
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â”œâ”€â”€ start.sh                     # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â””â”€â”€ test-server.sh              # æµ‹è¯•è„šæœ¬
```

### 2. æ ¸å¿ƒåŠŸèƒ½

âœ… **RESTful API**
- `POST /api/recording/save` - ä¿å­˜å½•åˆ¶æ•°æ®
- `GET /api/recording/list` - è·å–å½•åˆ¶åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€æ’åºï¼‰
- `GET /api/recording/:id` - è·å–æŒ‡å®šå½•åˆ¶
- `DELETE /api/recording/:id` - åˆ é™¤å½•åˆ¶
- `GET /api/playback/:id` - ç”Ÿæˆå›æ”¾é¡µé¢
- `GET /health` - å¥åº·æ£€æŸ¥

âœ… **æ•°æ®ç®¡ç†**
- åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å­˜å‚¨
- è‡ªåŠ¨ç”Ÿæˆç´¢å¼•
- UUID å”¯ä¸€æ ‡è¯†
- å…ƒæ•°æ®è®°å½•ï¼ˆæ—¶é—´ã€äº‹ä»¶æ•°ã€æ—¶é•¿ç­‰ï¼‰

âœ… **å®‰å…¨å’Œæ€§èƒ½**
- CORS è·¨åŸŸæ”¯æŒ
- è¯·æ±‚ä½“å¤§å°é™åˆ¶ï¼ˆ50MBï¼‰
- Gzip å‹ç¼©
- HTTP æ—¥å¿—è®°å½•
- å®Œæ•´çš„é”™è¯¯å¤„ç†

âœ… **å¼€å‘å‹å¥½**
- è¯¦ç»†çš„ API æ–‡æ¡£
- Vue é›†æˆç¤ºä¾‹
- API æµ‹è¯•è„šæœ¬
- è‡ªåŠ¨åˆ›å»ºæ•°æ®ç›®å½•

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡å™¨

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬
cd package/server
./start.sh

# æ–¹å¼2ï¼šnpmå‘½ä»¤
npm run dev        # å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm start          # ç”Ÿäº§æ¨¡å¼

# æ–¹å¼3ï¼šä»é¡¹ç›®æ ¹ç›®å½•
npm run dev:server
```

### æµ‹è¯• API

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
cd package/server
./test-server.sh

# æˆ–ä½¿ç”¨ Node.js æµ‹è¯•
npm install node-fetch  # å¦‚æœè¿˜æ²¡æœ‰
node test/api-test.js
```

### API ç¤ºä¾‹

**ä¿å­˜å½•åˆ¶ï¼š**
```bash
curl -X POST http://localhost:3000/api/recording/save \
  -H "Content-Type: application/json" \
  -d '{
    "events": [{"type": 4, "timestamp": 1234567890}],
    "metadata": {"title": "æµ‹è¯•å½•åˆ¶"}
  }'
```

**è·å–åˆ—è¡¨ï¼š**
```bash
curl http://localhost:3000/api/recording/list
```

**æŸ¥çœ‹å›æ”¾ï¼š**
```bash
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
open http://localhost:3000/api/playback/{recording-id}
```

## ğŸ”— å‰ç«¯é›†æˆ

### åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨

å‚è€ƒ `examples/vue-integration.js`ï¼š

```javascript
import { useRecording } from './composables/useRecording';

// åœ¨ç»„ä»¶ä¸­
const {
  isRecording,
  startRecording,
  stopRecording,
  saveRecording,
  openPlayback
} = useRecording();

// å¼€å§‹å½•åˆ¶
startRecording();

// åœæ­¢å¹¶ä¿å­˜
stopRecording();
const result = await saveRecording({
  title: 'ç”¨æˆ·æ“ä½œå½•åˆ¶'
});

// æ‰“å¼€å›æ”¾
openPlayback(result.recordingId);
```

## ğŸ“Š æ•°æ®æ ¼å¼

### å½•åˆ¶æ•°æ®ç»“æ„

```json
{
  "id": "uuid",
  "events": [
    {
      "type": 4,
      "data": {...},
      "timestamp": 1234567890
    }
  ],
  "metadata": {
    "title": "å½•åˆ¶æ ‡é¢˜",
    "recordedAt": "2025-12-31T...",
    "eventCount": 100,
    "duration": 5000,
    "userAgent": "...",
    "url": "..."
  }
}
```

### ç´¢å¼•æ–‡ä»¶ç»“æ„

```json
{
  "recordings": [
    {
      "id": "uuid",
      "title": "å½•åˆ¶æ ‡é¢˜",
      "recordedAt": "2025-12-31T...",
      "eventCount": 100,
      "duration": 5000
    }
  ]
}
```

## ğŸ¯ ä¸å…¶ä»–åŒ…çš„å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ application â”‚  å½•åˆ¶ç”¨æˆ·æ“ä½œ
â”‚  (Vue 3)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTP POST
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   server    â”‚  å­˜å‚¨å½•åˆ¶æ•°æ®
â”‚  (Express)  â”‚  ç”Ÿæˆå›æ”¾é¡µé¢
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    data/    â”‚  æ–‡ä»¶å­˜å‚¨
â”‚ recordings/ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

- **è¯·æ±‚å“åº”æ—¶é—´**: < 100msï¼ˆå°æ•°æ®ï¼‰
- **æœ€å¤§è¯·æ±‚ä½“**: 50MB
- **å¹¶å‘æ”¯æŒ**: å–å†³äº Node.js å•çº¿ç¨‹
- **å­˜å‚¨æ ¼å¼**: JSONï¼ˆæ˜“äºæŸ¥è¯¢å’Œè¿ç§»ï¼‰

## ğŸ”§ æ‰©å±•å»ºè®®

### çŸ­æœŸæ”¹è¿›
- [ ] æ·»åŠ ç”¨æˆ·è®¤è¯ï¼ˆJWTï¼‰
- [ ] å®ç°è¯·æ±‚é¢‘ç‡é™åˆ¶
- [ ] æ·»åŠ æ•°æ®éªŒè¯ä¸­é—´ä»¶
- [ ] æ”¯æŒå½•åˆ¶æ ‡ç­¾å’Œåˆ†ç±»

### ä¸­æœŸæ”¹è¿›
- [ ] è¿ç§»åˆ°æ•°æ®åº“ï¼ˆMongoDB/PostgreSQLï¼‰
- [ ] æ·»åŠ å…¨æ–‡æœç´¢åŠŸèƒ½
- [ ] å®ç°å½•åˆ¶åˆ†äº«åŠŸèƒ½
- [ ] æ·»åŠ  WebSocket å®æ—¶æ¨é€

### é•¿æœŸæ”¹è¿›
- [ ] å®ç°åˆ†å¸ƒå¼å­˜å‚¨
- [ ] æ·»åŠ æ•°æ®åˆ†æåŠŸèƒ½
- [ ] æ„å»ºç®¡ç†åå°
- [ ] äº‘å­˜å‚¨é›†æˆ

## ğŸ› æ³¨æ„äº‹é¡¹

1. **æ•°æ®ç›®å½•æƒé™**: ç¡®ä¿åº”ç”¨æœ‰è¯»å†™æƒé™
2. **ç«¯å£å†²çª**: å¦‚æœ 3000 ç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ PORT ç¯å¢ƒå˜é‡
3. **å¤§æ–‡ä»¶å¤„ç†**: 50MB é™åˆ¶å¯èƒ½éœ€è¦æ ¹æ®å®é™…è°ƒæ•´
4. **ç”Ÿäº§ç¯å¢ƒ**: å»ºè®®ä½¿ç”¨è¿›ç¨‹ç®¡ç†å™¨ï¼ˆPM2ï¼‰å’Œåå‘ä»£ç†ï¼ˆNginxï¼‰

## ğŸ” å®‰å…¨æé†’

### ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®

1. **HTTPS**: ä½¿ç”¨ SSL è¯ä¹¦
2. **è®¤è¯**: æ·»åŠ  JWT æˆ– OAuth
3. **CORS**: é™åˆ¶å…è®¸çš„æº
4. **è¾“å…¥éªŒè¯**: éªŒè¯æ‰€æœ‰è¾“å…¥æ•°æ®
5. **é€Ÿç‡é™åˆ¶**: é˜²æ­¢ DDoS æ”»å‡»

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Server README.md](../server/README.md) - è¯¦ç»† API æ–‡æ¡£
- [Vue é›†æˆç¤ºä¾‹](../server/examples/vue-integration.js)
- [API æµ‹è¯•è„šæœ¬](../server/test/api-test.js)

## âœ¨ æµ‹è¯•ç»“æœ

```
âœ… æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
âœ… å¥åº·æ£€æŸ¥æ­£å¸¸
âœ… æ•°æ®ç›®å½•è‡ªåŠ¨åˆ›å»º
âœ… æ‰€æœ‰ API ç«¯ç‚¹å¯ç”¨
```

---

**åˆ›å»ºæ—¶é—´**: 2026-01-04
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: âœ… å¯ç”¨

